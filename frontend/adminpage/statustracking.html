<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>โรงพยาบาลค่ายจิรประวัติ</title>
  <link rel="stylesheet" href="../../css/statustracking.css">
  <link rel="stylesheet" href="../../styles.css">
  <link rel="stylesheet" href="../../css/sidebar.css">
  <link rel="stylesheet" href="../../css/topbar.css">
  <link rel="stylesheet" href="../../css/logo.css">
  <!-- Import icon -->
  <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300&display=swap">
  <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="../method/logout.js"></script>
  <script src="../method/user.js"></script>
  <script src="../method/loadSidebarScript.js"></script>
  <script src="../method/checkAuth.js"></script>
</head>

<body style="background-color:#edeff1;">
  <div id="sidebar-container"></div>
  <div id="topbar-container"></div>

  <div class="statustracking-container">
    <!-- Filters -->
    <section class="filter-section" style="justify-content: center;">
      <div class="filter-container">
        <div class="filter-item search-bar">
          <h5>ค้นหารายชื่อ</h5>
          <input type="text" placeholder="ค้นหาที่นี่..." class="search-input" id="searchPatientInput">
          <i class='bx bx-search search-icon'></i>
        </div>
        <div class="filter-item">
          <h5>โรคประจำตัว</h5>
          <select class="dropdown-filter" id="treatmentCountFilter">
            <option value="">ทั้งหมด</option>
            <option value="ความดันโลหิตสูง">ความดันโลหิตสูง</option>
            <option value="โรคอ้วน">โรคอ้วน</option>
            <option value="ไขมันในเลือดสูง">ไขมันในเลือดสูง</option>
            <option value="โรคเบาหวาน">โรคเบาหวาน</option>
            <option value="CVD Risk">CVD Risk</option>
            <option value="โรคไต">โรคไต</option>
          </select>
        </div>
        <div class="filter-item">
          <h5>วันที่เริ่มติดตาม</h5>
          <input type="date" class="date-filter" id="appointmentDateFilter">
        </div>
        <div class="filter-item">
          <h5>กำหนดส่งงาน</h5>
          <input type="date" class="date-filter" id="DeadlineDateFilter">
        </div>
        <div class="filter-item">
          <h5>สถานะเข้ารับการรักษา</h5>
          <select class="dropdown-filter" id="treatmentStatusFilter">
            <option value="ทั้งหมด">ทั้งหมด</option>
            <option value="มาตามนัด">มาตามนัด</option>
            <option value="ไม่มาตามนัด">ไม่มาตามนัด</option>
          </select>
        </div>

        <div class="filter-item">
          <h5>สถานะการติดตาม</h5>
          <select class="dropdown-filter" id="treatmentStatusFilter">
            <option value="ทั้งหมด">ทั้งหมด</option>
            <option value="ยังไม่ได้รักษา">ยังไม่ได้ติดตาม</option>
            <option value="นัดติดตามต่อเนื่อง">ติดตามแล้ว</option>
            <option value="รักษาเสร็จสิ้น">กำลังติดตาม</option>
            <option value="รักษาเสร็จสิ้น">ติดตามล้มเหลว</option>
          </select>
        </div>

        <div id="download-pdf-button-container" title='ดาวน์โหลดPDF'>
          <button id="download-pdf-button">
            <i class='bx bxs-file-pdf'></i>
          </button>
        </div>

      </div>
    </section>

    <!-- Overlay สำหรับป๊อปอัป -->
    <div id="popup-overlay"></div>

    <!-- ป๊อปอัป -->
    <div id="popup-modal">
      <h2>เลือกผู้ป่วยที่ต้องการดาวน์โหลดข้อมูล</h2>
      <table id="popup-table" border="1" style="width: 100%; text-align: left;">
        <thead>
          <tr>
            <th style="width: 60px;">เลือก</th>
            <th>ชื่อผู้ป่วย</th>
            <th>ประเภทโรค</th>
            <th>ประเภทผู้ป่วย</th>
            <th>วันที่เริ่มติดตาม</th>
            <th>กำหนดส่งงาน</th>
            <th>สถานะการติดตาม</th>
          </tr>
        </thead>
        <tbody>
          <!-- ตารางข้อมูลผู้ป่วยจะแสดงในนี้ -->
        </tbody>
      </table>
      <div class="button_popup" style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 10px;">
        <button id="generate-pdf-button">สร้าง PDF</button>
        <button id="close-popup-button">ปิด</button>
      </div>

    </div>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const downloadPdfButton = document.getElementById('download-pdf-button');
        const popupModal = document.getElementById('popup-modal');
        const popupOverlay = document.getElementById('popup-overlay');  // Reference to overlay
        const popupTableBody = document.querySelector('#popup-table tbody');
        const generatePdfButton = document.getElementById('generate-pdf-button');
        const closePopupButton = document.getElementById('close-popup-button');

        // ฟังก์ชันเปิดป๊อปอัปและดึงข้อมูลจาก API
        async function openPopup() {
          popupOverlay.style.display = 'block';  // Show overlay
          popupModal.style.display = 'block';   // Show modal

          // ล้างข้อมูลในตารางป๊อปอัป
          popupTableBody.innerHTML = '';

          try {
            // ดึงข้อมูลผู้ป่วยจาก API
            const response = await fetch('/chiracarehospital/backend/sql/monitoring/patient_list.php');
            const data = await response.json();

            // ตรวจสอบหากไม่มีข้อมูล
            if (!data || data.length === 0) {
              alert('ไม่มีข้อมูลผู้ป่วย');
              popupModal.style.display = 'none';
              popupOverlay.style.display = 'none';  // Hide overlay
              return;
            }

            // แสดงข้อมูลในตารางป๊อปอัป
            data.forEach(patient => {
              const { full_name, disease_type, patient_type, monitor_date, monitor_deadline, monitor_status } = patient;

              const tr = document.createElement('tr');
              tr.innerHTML = `
          <td style="width: 60px;"><input type="checkbox" class="popup-patient-checkbox" /></td>
          <td>${full_name || 'ไม่ระบุชื่อ'}</td>
          <td>${disease_type || 'ไม่ระบุโรค'}</td>
          <td>${patient_type || 'ไม่ระบุประเภทผู้ป่วย'}</td>
          <td>${monitor_date || 'ไม่ระบุวันที่เริ่มติดตาม'}</td>
          <td>${monitor_deadline || 'ไม่ระบุกำหนดส่งงาน'}</td>
          <td>${monitor_status || 'ไม่ระบุสถานะการติดตาม'}</td>
        `;
              popupTableBody.appendChild(tr);
            });
          } catch (error) {
            console.error('เกิดข้อผิดพลาดในการดึงข้อมูล:', error);
            alert('ไม่สามารถดึงข้อมูลผู้ป่วยได้');
            popupModal.style.display = 'none';
            popupOverlay.style.display = 'none';  // Hide overlay if error
          }
        }

        // ฟังก์ชันปิดป๊อปอัป
        closePopupButton.addEventListener('click', () => {
          popupModal.style.display = 'none';
          popupOverlay.style.display = 'none';  // Hide overlay when closing popup
        });

        // แสดงป๊อปอัปเมื่อคลิกปุ่ม "ดาวน์โหลด PDF"
        downloadPdfButton.addEventListener('click', openPopup);

        // ฟังก์ชันสร้าง PDF
        generatePdfButton.addEventListener('click', () => {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          // เพิ่มฟอนต์ภาษาไทย
          const fontBase64 = "YOUR_BASE64_ENCODED_FONT_HERE"; // ฟอนต์ Base64
          doc.addFileToVFS("THSarabunNew.ttf", fontBase64);
          doc.addFont("THSarabunNew.ttf", "THSarabunNew", "normal");
          doc.setFont("THSarabunNew");

          // ดึงข้อมูลผู้ป่วยที่เลือกจากป๊อปอัป
          const selectedPatients = Array.from(document.querySelectorAll('.popup-patient-checkbox:checked')).map(checkbox => {
            const row = checkbox.closest('tr');
            const cells = row.cells;
            return {
              full_name: cells[1]?.innerText || 'ไม่ระบุชื่อ',
              disease_type: cells[2]?.innerText || 'ไม่ระบุโรค',
              patient_type: cells[3]?.innerText || 'ไม่ระบุประเภทผู้ป่วย',
              monitor_date: cells[4]?.innerText || 'ไม่ระบุวันที่เริ่มติดตาม',
              monitor_deadline: cells[5]?.innerText || 'ไม่ระบุกำหนดส่งงาน',
              monitor_status: cells[6]?.innerText || 'ไม่ระบุสถานะการติดตาม',
            };
          });

          if (selectedPatients.length === 0) {
            alert('กรุณาเลือกผู้ป่วยก่อนสร้าง PDF');
            return;
          }

          // เพิ่มข้อมูลใน PDF
          let y = 10; // ตำแหน่งแนวตั้งเริ่มต้น
          selectedPatients.forEach((patient, index) => {
            doc.setFontSize(12);
            doc.text(`${index + 1}. ชื่อผู้ป่วย: ${patient.full_name}`, 10, y);
            doc.text(`ประเภทโรค: ${patient.disease_type}`, 10, y + 10);
            doc.text(`ประเภทผู้ป่วย: ${patient.patient_type}`, 10, y + 20);
            doc.text(`วันที่เริ่มติดตาม: ${patient.monitor_date}`, 10, y + 30);
            doc.text(`กำหนดส่งงาน: ${patient.monitor_deadline}`, 10, y + 40);
            doc.text(`สถานะการติดตาม: ${patient.monitor_status}`, 10, y + 50);
            y += 60;
          });

          // ดาวน์โหลด PDF
          doc.save('patient_report.pdf');
          popupModal.style.display = 'none'; // ปิดป๊อปอัป
          popupOverlay.style.display = 'none';  // Hide overlay
        });

      });
    </script>

    <div id="button-container">
      <button id="assign-button" style="display: none;">มอบหมายงาน</button>
    </div>

    <div class="table-container">
      <table class="patient-table">
        <thead>
          <tr>
            <th>
              <input type="checkbox" id="select-all" class="select-all">
            </th>
            <th>ชื่อผู้ป่วย</th>
            <th>โรคประจำตัว</th>
            <th>ประเภทผู้ป่วย</th>
            <th>วันที่เริ่มติดตาม</th>
            <th>กำหนดส่งงาน</th>
            <th>ครั้งที่ติดตาม</th>
            <th>สถานะเข้ารับการรักษา</th>
            <th>สถานะการติดตาม</th>
            <th>การจัดการ</th>
          </tr>
        </thead>
        <tbody>
          <!-- ข้อมูลผู้ป่วยจะถูกเติมที่นี่ -->
        </tbody>
      </table>
    </div>
  </div>

  <div id="confirmation-popup" style="display:none;">
    <div class="popup-content">
      <h2>กรุณาตรวจสอบรายชื่อผู้ป่วยที่ต้องการติดตาม</h2>
      <p id="patient-count"></p>
      <!-- เรียกใช้ตารางแทนรายการผู้ป่วย -->
      <div id="patient-table-wrapper">
        <table id="patient-table">
          <thead>
            <tr>
              <th>ID ผู้ป่วย</th>
              <th>ชื่อผู้ป่วย</th>
              <th>โรคประจำตัว</th>
            </tr>
          </thead>
          <tbody id="patient-list"></tbody>
        </table>
      </div>
      <div id="overlay"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);">
      </div>
      <div class="text">
        <label for="monitor-start-date">วันที่เริ่มติดตาม:</label>
        <input type="date" id="monitor-start-date" required>
        <label for="monitor-deadline">กำหนดส่งผลการติดตาม:</label>
        <input type="date" id="monitor-deadline" required>
      </div>
      <button type="Yes" id="confirm-assign">ยืนยัน</button>
      <button type="No" id="cancel-assign">ยกเลิก</button>
    </div>
  </div>



  <script>
    // ดึงวันที่ปัจจุบัน
    const today = new Date().toISOString().split('T')[0];

    // ตั้งค่า min เป็นวันที่ปัจจุบัน
    document.getElementById('monitor-deadline').setAttribute('min', today);
    document.getElementById('monitor-start-date').setAttribute('min', today); // วันที่เริ่มติดตามต้องไม่ย้อนกลับ

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('cancel-assign').addEventListener('click', function () {
        const confirmationPopup = document.getElementById('confirmation-popup');
        const overlay = document.getElementById('overlay');

        if (confirmationPopup) {
          confirmationPopup.style.display = 'none';
        }
        if (overlay) {
          overlay.style.display = 'none';
        }
      });

      const assignButton = document.getElementById('assign-button');
      const patientCountElement = document.getElementById('patient-count');
      const patientList = document.getElementById('patient-list');
      const checkboxes = document.querySelectorAll('.patient-checkbox');

      checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function () {
          const anyChecked = Array.from(checkboxes).some(cb => cb.checked);
          assignButton.style.display = anyChecked ? 'block' : 'none';
        });
      });

      assignButton.addEventListener('click', function () {
        const selectedPatients = Array.from(document.querySelectorAll('.patient-checkbox:checked')).map(checkbox => {
          return {
            patientId: parseInt(checkbox.value),
            fullName: checkbox.getAttribute('data-full-name'),
            diseaseType: checkbox.getAttribute('data-disease-type')
          };
        });

        if (selectedPatients.length === 0) {
          alert('กรุณาเลือกผู้ป่วยก่อนมอบหมายงาน');
          return;
        }

        if (patientCountElement) {
          patientCountElement.textContent = `จำนวนผู้ป่วยที่เลือก: ${selectedPatients.length}`;
        }

        if (patientList) {
          patientList.innerHTML = '';
          selectedPatients.forEach(patient => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
        <td>${patient.patientId}</td>
        <td>${patient.fullName}</td>
        <td>${patient.diseaseType}</td>
      `;
            patientList.appendChild(tr);
          });
        }

        document.getElementById('confirmation-popup').style.display = 'block';
        document.getElementById('overlay').style.display = 'flex';
      });

      document.getElementById('confirm-assign').addEventListener('click', async function () {
        const selectedPatients = Array.from(document.querySelectorAll('.patient-checkbox:checked')).map(checkbox => {
          return parseInt(checkbox.value);
        });

        if (selectedPatients.length === 0) {
          alert('กรุณาเลือกผู้ป่วยก่อนมอบหมายงาน');
          return;
        }

        const monitorStatus = 'กำลังติดตาม'; // สถานะการติดตามที่เราต้องการ
        const monitorDeadline = document.getElementById('monitor-deadline').value; // วันหมดอายุ
        const monitorStartDate = document.getElementById('monitor-start-date').value; // วันเริ่มติดตาม

        // ตรวจสอบค่าวันที่ก่อนส่ง
        console.log('Monitor Deadline:', monitorDeadline);
        console.log('Monitor Start Date:', monitorStartDate);

        try {
          const response = await fetch('/chiracarehospital/backend/sql/monitoring/update_patient_status.php', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              monitorStatus: monitorStatus,
              patientIds: selectedPatients,
              monitorDeadline: monitorDeadline,
              monitorStartDate: monitorStartDate // ส่งวันที่เริ่มติดตาม
            })
          });

          const responseData = await response.json();

          if (responseData.status === 'success') {
            alert(`อัปเดตสถานะสำเร็จ: ${responseData.updated_count} รายการ`);
            document.getElementById('confirmation-popup').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
            window.location.reload(); // รีเฟรชหน้าเว็บ
          } else {
            alert(`เกิดข้อผิดพลาด: ${responseData.message}`);
          }
        } catch (error) {
          console.error('Error:', error);
          alert('เกิดข้อผิดพลาดในการอัปเดตสถานะการติดตาม: ' + error.message);
        }
      });
    });
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      fetchPatientData();

      // Status color
      function getStatusClass(status) {
        switch (status) {
          case 'ยังไม่ได้ติดตาม': return 'uncomplete';
          case 'กำลังติดตาม': return 'in-progress';
          case 'ติดตามแล้ว': return 'completed';
          case 'ติดตามล้มเหลว': return 'failed';
          case 'ยังไม่ได้รักษา': return 'unsucess';
          case 'นัดติดตามต่อเนื่อง': return 'unsucess';
          case 'รักษาเสร็จสิ้น': return 'unsucess';
          default: return 'other';
        }
      }

      // ฟังก์ชันสำหรับดึงข้อมูลผู้ป่วยพร้อมการจัดเรียงตามสถานะการติดตาม
      async function fetchPatientData() {
        const tbody = document.querySelector('.patient-table tbody');
        try {
          const response = await fetch('/chiracarehospital/backend/sql/monitoring/patient_list.php');
          if (!response.ok) throw new Error('Network response was not ok: ' + response.statusText);

          let data = await response.json();

          // ลำดับการจัดเรียงสถานะตามที่กำหนด
          const statusOrder = {
            'ยังไม่ได้ติดตาม': 1,
            'ติดตามล้มเหลว': 2,
            'กำลังติดตาม': 3,
            'ติดตามแล้ว': 4
          };

          // จัดเรียงข้อมูลตามสถานะการติดตาม
          data.sort((a, b) => {
            const statusA = statusOrder[a.monitor_status] || 5;
            const statusB = statusOrder[b.monitor_status] || 5;
            return statusA - statusB;
          });

          tbody.innerHTML = '';

          if (!Array.isArray(data) || data.length === 0) {
            tbody.innerHTML = `<tr><td colspan="10">ไม่มีข้อมูลผู้ป่วย</td></tr>`;
            document.getElementById('assign-button').style.display = 'none';
            return;
          }

          data.forEach(patient => {
            const isMonitoringPending = patient.monitor_status === 'ยังไม่ได้ติดตาม';
            const isMonitoringFailed = patient.monitor_status === 'ติดตามล้มเหลว';

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${isMonitoringPending || isMonitoringFailed ? `<input type='checkbox' class='patient-checkbox' value='${patient.patient_id}' data-full-name='${patient.full_name}' data-disease-type='${patient.disease_type}'>` : `<div class="unselectable-box"></div>`}</td>
                <td>${patient.full_name ? patient.full_name : `<span class="no-data">ไม่มีข้อมูล</span>`}</td>
                <td>${patient.disease_type ? patient.disease_type : `<span class="no-data">ไม่มีข้อมูล</span>`}</td>
                <td>${patient.patient_type ? patient.patient_type : `<span class="no-data">ไม่มีข้อมูล</span>`}</td>
                <td>${patient.monitor_date ? patient.monitor_date : `<span class="no-data">ไม่มี</span>`}</td>
                <td>${patient.monitor_deadline ? patient.monitor_deadline : `<span class="no-data">ไม่มี</span>`}</td>
                <td>${patient.monitor_round ? patient.monitor_round : `<span class="no-data">ไม่มี</span>`}</td>
                <td><span class='status ${getStatusClass(patient.treatment_status)}'>${patient.treatment_status ? patient.treatment_status : `<span class="no-data">ไม่มีข้อมูล</span>`}</span></td>
                <td><span class='status ${getStatusClass(patient.monitor_status)}'>${patient.monitor_status ? patient.monitor_status : `<span class="no-data">ไม่มีข้อมูล</span>`}</span></td>
                <td>
                
                    <button class='action-btn' title='แก้ไขข้อมูล' onclick="location.href='edittracking.html?patient_id=${patient.patient_id}&full_name=${patient.full_name}&disease=${patient.disease_type}';">
  <i class='bx bx-edit'></i>
</button>

                    <button class='action-btn' title='ดูเพิ่มเติม' onclick="location.href='moreinfo.html?patient_id=${patient.patient_id}&full_name=${patient.full_name}&disease=${patient.disease_type}';"><i class='bx bx-right-arrow-alt'></i></button>
                </td>`;
            tbody.appendChild(row);
          });

          updateAssignButtonVisibility();

        } catch (error) {
          console.error('Error:', error);
          tbody.innerHTML = `<tr><td colspan="10">เกิดข้อผิดพลาดในการดึงข้อมูล: ${error.message}</td></tr>`;
          document.getElementById('assign-button').style.display = 'none';
        }
      }


      function updateAssignButtonVisibility() {
        const selectedPatients = document.querySelectorAll('.patient-checkbox:checked');
        document.getElementById('assign-button').style.display = selectedPatients.length > 0 ? 'block' : 'none';
      }

      function initializeSidebar() {
        let sidebar = document.querySelector(".sidebar");
        let closeBtn = document.querySelector("#btn");

        closeBtn.addEventListener("click", () => {
          sidebar.classList.toggle("active");
          closeBtn.classList.toggle("bx-menu");
          closeBtn.classList.toggle("bx-menu-alt-right");
        });
      }

      // ฟังก์ชันสำหรับการเลือกผู้ป่วยทั้งหมด
      document.getElementById('select-all').addEventListener('change', function () {
        const checkboxes = document.querySelectorAll('.patient-checkbox');
        checkboxes.forEach(checkbox => {
          checkbox.checked = this.checked;
        });
        updateAssignButtonVisibility();
      });

      // ฟังก์ชันสำหรับการจัดการการเลือกผู้ป่วย
      document.addEventListener('change', function (event) {
        if (event.target.classList.contains('patient-checkbox')) {
          updateAssignButtonVisibility();
        }
      });
    });

  </script>

  <script>
    // เรียกฟังก์ชัน checkAuth() เพื่อตรวจสอบ token
    checkAuth();

    // Load sidebar
    fetch('sidebar.html')
      // ใช้ fetch เพื่อดึงข้อมูล sidebar.html
      .then(response => response.text())
      // แปลงข้อมูลที่ได้รับเป็นข้อความ
      .then(data => {
        document.getElementById('sidebar-container').innerHTML = data;
        // นำข้อมูลที่ดึงมาแสดงใน sidebar-container
        loadSidebarScript();
        // เรียกฟังก์ชัน loadSidebarScript() เพื่อทำงานเพิ่มเติมกับ sidebar
      });

    // Load topbar and set the page title
    fetch('topbar.html')
      // ใช้ fetch เพื่อดึงข้อมูล topbar.html
      .then(response => response.text())
      // แปลงข้อมูลที่ได้รับเป็นข้อความ
      .then(data => {
        document.getElementById('topbar-container').innerHTML = data;
        // นำข้อมูลที่ดึงมาแสดงใน topbar-container
        document.getElementById('page-title').textContent = 'ติดตามผู้ป่วยที่ไม่มาเข้ารับการรักษา';
        // กำหนดชื่อเรื่องของหน้าเป็น 'หน้าหลัก'

        // Re-run user.js script after loading topbar
        const script = document.createElement('script');
        // สร้างแท็ก script ใหม่
        script.src = '../method/user.js';
        // กำหนดแหล่งที่มาของ script เป็น user.js
        document.body.appendChild(script);
        // เพิ่มแท็ก script ลงใน body ของเอกสารเพื่อทำการโหลดสคริปต์
      });
  </script>

</body>

<style>
  .no-data {
    color: red;
    /* กำหนดสีของข้อความเป็นสีแดง */
    /* font-style: italic; */
  }

  .unselectable-box {
    width: 20px;
    height: 20px;
    background-color: #d9d9d9;
    /* สีพื้นหลังทึบ */
    border: 1px solid #a6a6a6;
    /* สีขอบ */
    border-radius: 4px;
    display: inline-block;
  }

  td .patient-checkbox {
    width: 20px;
    height: 20px;
    border-radius: 4px;
  }

  th .select-all {
    width: 20px;
    height: 20px;
    border-radius: 4px;
  }

  /* การตั้งค่ารูปแบบของตาราง */
  #patient-table {
    width: 100%;
    border-collapse: collapse;
    /* รวมเส้นขอบให้ดูเรียบ */
    margin-top: 5px;
    margin-bottom: 20px;
  }

  /* การตั้งค่าของแต่ละเซลล์ในตาราง */
  #patient-table th,
  #patient-table td {
    padding: 10px;
    /* เพิ่มช่องว่างในเซลล์ */
    text-align: left;
    /* จัดการข้อความในแต่ละเซลล์ให้ชิดซ้าย */
    border: 1px solid #ddd;
    /* เส้นขอบที่อ่อน */
  }

  /* การตั้งค่าให้แถวที่เป็น header มีลักษณะเด่น */
  #patient-table th {
    background-color: #f2f2f2;
    /* พื้นหลังสีอ่อน */
    font-weight: bold;
    /* ตัวหนาสำหรับหัวตาราง */
  }

  /* การตั้งค่าของแถวที่มีเส้นขอบหนา */
  #patient-table tbody tr:nth-child(even) {
    background-color: #f9f9f9;
    /* สีพื้นหลังของแถวคู่ */
  }

  #patient-table tbody tr:nth-child(odd) {
    background-color: #fff;
    /* สีพื้นหลังของแถวคี่ */
  }

  /* ทำให้ตารางมีลูกเลื่อนแนวตั้ง */
  #patient-table-wrapper {
    display: block;
    max-height: 300px;
    /* กำหนดความสูงสูงสุด */
    overflow-y: auto;
    /* เพิ่มลูกเลื่อนแนวตั้ง */
  }

  /* ปรับให้ <thead> และ <tbody> แสดงเป็นตารางเดียวกัน */
  #patient-table thead,
  #patient-table tbody {
    display: table;
    width: 100%;
    table-layout: fixed;
    border-collapse: collapse;
  }

  /* ทำให้คอลัมน์ header (thead) ติดอยู่ด้านบน */
  #patient-table thead {
    z-index: 2;
    /* ให้แน่ใจว่าหัวตารางจะอยู่ด้านบน */
    background-color: #f2f2f2;
    /* ทำให้หัวตารางมีพื้นหลัง */
  }

  #patient-count {
    margin-top: 20px;
  }
</style>

</html>